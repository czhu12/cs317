still think it should be "typedef struct map {...} map" instead of "typedef struct map {...} *map
